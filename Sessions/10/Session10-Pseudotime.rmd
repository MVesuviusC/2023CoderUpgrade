---
title: "SCRGOT 2023 Coder Upgrade Session 10 - Pseudotime analysis and RNA velocity"
author: "Ryan Roberts"
date: "3/4/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(patchwork)
library(rrrSingleCellUtils)
library(Seurat)
library(monocle3)

theme_set(theme_classic())
```

## Import a merged bone tumor object 

This object contains tumor cells isolated from a collection of clinical specimens sequenced using a 3'-capture, microfluidic partitioning approach (10x). The data have already been processed, including isolation/sublustering of tumor cells (other cell types have been filtered out), normalization, scaling, FindNeighbors, FindClusters, etc. The associated metadata contain some potentially useful annotations:
    - $src: a study ID representing the original source (patient) that the tumor was taken from
    - $type: location of the tumor when removed from the patient (Primary or Metastasis)
    - $path: the pathology classification of the tumor (Conventional, Chondroblastic, Telangiectatic, etc.)
    - $gse: the GEO/SRA accession number where the raw data is stored

Start by loading the data and visualizing the appearance/clustering as processed previously.

```{r import_data}
# Load the Seurat object into the namespace as "scdata"
sc_data <- qs::qread("osteoshark.qs")

# Plot the data as it has been processed
r_dim_plot(sc_data, "Starting Processed Data")
```

## Practice 1: Basic pseudotime analysis and visualization 

***

```{r enrollment}
# Convert the Seurat object to a SingleCellExperiment object
cds_data <- SeuratWrappers::as.cell_data_set(sc_data, group.by = "assignment") %>%
    preprocess_cds(num_dim = 30) %>%
    align_cds(alignment_group = "src") %>%
    reduce_dimension()

plot_cells(cds_data)

```

## Generate class rosters

Process the data to generate lists of students enrolled in each course and lists of experienced coders willing to mentor.

```{r rosters, results='asis'}

```

